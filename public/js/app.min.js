"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function getClassName(cssSelector){return cssSelector.replace(".","")}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),Countdown=function(){function Countdown(options){_classCallCheck(this,Countdown),this.today=new Date;var endDate=new Date(options.endDate);if(isNaN(endDate.getTime()))throw Error("Invalid target date: "+options.endDate);if(endDate<=this.today)throw Error("Must be a future date: "+options.endDate);if(this.endDate=endDate,options.startDate){var startDate=new Date(options.startDate);if(isNaN(endDate.getTime()))throw Error("Invalid start date: "+options.startDate);if(startDate>=this.today)throw Error("Must be a past date: "+options.startDate);this.startDate=startDate}else this.startDate=new Date(endDate.getFullYear(),0,1)}return _createClass(Countdown,[{key:"getNoOfWeekendsBetween",value:function(startDate,endDate){startDate.setHours(0,0,0),endDate.setHours(23,59,59);var daysBeforeFirstSaturday=6-startDate.getDay(),daysAfterLastSaturday=endDate.getDay()+1;daysAfterLastSaturday>6&&(daysAfterLastSaturday=0);var totalDays=(endDate-startDate)/864e5;return Math.round((totalDays-daysBeforeFirstSaturday-daysAfterLastSaturday)/7)}},{key:"getGraphHtml",value:function(){for(var html="",year=this.startDate.getFullYear();year<=this.endDate.getFullYear();year++)for(var month=0;month<12;month++)if(!(year===this.startDate.getFullYear()&&month<this.startDate.getMonth())){if(year===this.endDate.getFullYear()&&month>this.endDate.getMonth())break;var monthTitle=this.getMonthLabel(month);this.startDate.getFullYear()!==this.endDate.getFullYear()&&(monthTitle+=" "+year),html+='<ul class="graph__month" title="'+monthTitle+'">';var firstDateOfMonth=new Date(year,month,1),lastDateOfMonth=new Date(year,month+1,0),noOfWeekends=this.getNoOfWeekendsBetween(firstDateOfMonth,lastDateOfMonth),elapsedWeekends=noOfWeekends,elapsedYear=year<this.today.getFullYear(),elapsedMonth=year<=this.today.getFullYear()&&month<this.today.getMonth(),curMonth=year===this.today.getFullYear()&&month===this.today.getMonth(),curWeekendProcessed=!1,graphClasses={weekElapsed:"graph__week--elapsed",week:"graph__week",weekCurrent:"graph__week--current"};month===this.today.getMonth()&&(elapsedWeekends=this.getNoOfWeekendsBetween(firstDateOfMonth,this.today));for(var weekend=0;weekend<=noOfWeekends;weekend++){var weekClass="";(elapsedYear||elapsedMonth)&&(weekClass=graphClasses.weekElapsed),curMonth&&(weekend<=elapsedWeekends?weekClass=graphClasses.weekElapsed:curWeekendProcessed||(weekClass=graphClasses.weekCurrent,curWeekendProcessed=!0)),html+='<li class="'+graphClasses.week+" "+weekClass+'"></li>'}html+="</ul>"}return html}},{key:"getMonthLabel",value:function(month){return["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][month]}},{key:"getSummary",value:function(){return{totalWeekends:this.getNoOfWeekendsBetween(this.startDate,this.endDate),remainingWeekends:this.getNoOfWeekendsBetween(this.today,this.endDate),endDate:this.formatDate(this.endDate)}}},{key:"formatDate",value:function(dt){return dt.getDate()+" "+this.getMonthLabel(dt.getMonth())+" "+dt.getFullYear()}}]),Countdown}();void 0===Countdown||_typeof(Countdown);var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),Tabs=function(){function Tabs($root,data){_classCallCheck(this,Tabs),this.cssSelectors={tabList:".tab-list",tabItem:".tab-list__item",tabLink:".tab-list__link",barChartElapsed:".bar-chart__elapsed",summaryCount:".summary__count",summaryDate:".summary__date",graph:".graph"};var listClass=getClassName(this.cssSelectors.tabList);if(!$root.hasClass(listClass))throw new Error('Expected an element with class "'+listClass+'"');this.$root=$root,this.data=data,this.bindUIActions(),this.init()}return _createClass(Tabs,[{key:"init",value:function(){var html="";for(var i in this.data){var item=this.data[i],active="";0===i&&(active="active"),html+='<li class="tab-list__item '+active+'">\n        <a class="tab-list__link" href="#'+this.generateAnchor(item.name)+'" data-start="'+item.startDate+'" data-end="'+item.endDate+'">'+item.name+"</a>\n      </li>"}this.$root.html(html),$(this.cssSelectors.tabLink).eq(0).click()}},{key:"bindUIActions",value:function(){$(this.cssSelectors.tabList).on("click",this.cssSelectors.tabLink,this.reloadCountdown.bind(this))}},{key:"generateAnchor",value:function(name){return encodeURIComponent(name.toLowerCase().replace(" ","-"))}},{key:"reloadCountdown",value:function(ev){ev.preventDefault();var $link=$(ev.currentTarget),countdown=new Countdown({startDate:$link.data("start"),endDate:$link.data("end")}),summary=countdown.getSummary();$(this.cssSelectors.summaryCount).text(summary.remainingWeekends),$(this.cssSelectors.summaryDate).text(summary.endDate),$(this.cssSelectors.barChartElapsed).width(Math.round(100*summary.remainingWeekends/summary.totalWeekends)+"%"),$(this.cssSelectors.graph).html(countdown.getGraphHtml()),$link.parent(this.cssSelectors.tabItem).addClass("active").siblings().removeClass("active")}}]),Tabs}();void 0===Tabs||_typeof(Tabs);